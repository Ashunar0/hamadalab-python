# SL/FC識別改善のための新規特徴量追加に関する報告書

## 1. 目的
Slider (SL) が Cutter (FC) と誤分類される（Misclassification）問題を解決するため、以下の3つの新規特徴量を追加し、モデルの性能変化を検証しました。

**追加した特徴量:**
1. **`velocity_abs_pfx_x_ratio`**: $\frac{\text{球速}}{|\text{水平変化量}| + 0.1}$
2. **`velocity_times_pfx_z`**: $\text{球速} \times \text{垂直変化量}$
3. **`pfx_z_minus_abs_pfx_x`**: $\text{垂直変化量} - |\text{水平変化量}|$

## 2. 検証方法
- **ベースライン**: 既存の19特徴量を用いたXGBoostモデル
- **検証モデル**: 新規3特徴量を追加した計22特徴量を用いたXGBoostモデル
- **評価指標**: テストデータにおける SL -> FC の誤分類数（混同行列を用いて算出）

## 3. 検証結果

### 3.1 誤分類数の変化
新しい特徴量を追加した結果、SLからFCへの誤分類は**わずかに増加（悪化）**しました。

| モデル | SL -> FC 誤分類数 | 変化 |
| :--- | :--- | :--- |
| ベースライン (19特徴量) | **2,095** | - |
| 新規モデル (22特徴量) | **2,108** | **+13 (+0.62%)** |

### 3.2 特徴量重要度 (Feature Importance)
興味深いことに、追加した特徴量のうち **`velocity_times_pfx_z`** はモデル内で最も重要な特徴量として扱われています。

| 順位 | 特徴量 | 重要度 | 備考 |
| :--- | :--- | :--- | :--- |
| **1** | **`velocity_times_pfx_z`** | **0.2520** | **新規追加** |
| 2 | `pfx_x` | 0.1361 | 既存 |
| 3 | `spin_efficiency` | 0.1020 | 既存 |
| ... | ... | ... | ... |
| 19 | `velocity_abs_pfx_x_ratio` | 0.0128 | 新規追加 |
| 21 | `pfx_z_minus_abs_pfx_x` | 0.0124 | 新規追加 |

## 4. 考察と結論

1. **`velocity_times_pfx_z` の影響**:
   - この特徴量はモデル全体としては非常に重要視されています（重要度1位）。これは、球速と垂直変化量の相互作用が球種判別全般において強力な情報を持っていることを示唆しています。
   - しかし、**SL vs FC の識別精度向上には寄与しませんでした**。むしろ、この特徴量に頼ることで一部のSLがFCと誤認されやすくなった可能性があります。

2. **他の新規特徴量**:
   - `velocity_abs_pfx_x_ratio` と `pfx_z_minus_abs_pfx_x` の重要度は低く、モデルへの貢献は限定的でした。

3. **総評**:
   - 今回提案された特徴量は、全体的なモデル構造には影響を与えましたが、特定の課題である「SLのFCへの誤分類」を解決するには至りませんでした。
   - 次のステップとして、SLとFCの物理的な境界（例えば、ジャイロ成分や特定の変化量域）に特化した別の特徴量を検討するか、誤分類されたケース（Worst Cases）の詳細分析が必要です。
