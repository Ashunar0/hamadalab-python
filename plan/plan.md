## テーマ案：pybaseball を使った「強打者予測」入門プロジェクト

### 1. 企画のねらい

- **目的**: Kaggle Titanic 初心者ノート（`beginner.ipynb`）とほぼ同じ流れを、野球データ（`pybaseball`）に置き換えて体験する。
  - Titanic では「乗客が生き残ったかどうか（0/1）」を予測したが、ここでは
    - **「ある年の打者が “強打者” かどうか（0/1）」を予測する**  
      をゴールにする。
- **ねらい**:
  - 実データ（MLB 打撃成績）を使って、**データ読み込み → EDA → 前処理 → モデル学習 → 予測**という一連の流れを、小さなスケールで一通り経験する。
  - 数式よりも「やってみてイメージをつかむ」ことを重視し、初心者でもついていける難易度にする。

---

### 2. 具体的にやること（ざっくり）

- **タスクのイメージ**

  - `pybaseball` で MLB の打撃成績（例: 2021〜2023 年）を取得する。
  - 各打者について、その年の OPS（または wOBA など）を使い、
    - **リーグ中央値より OPS が高い → 1（強打者）**
    - **それ以外 → 0（非・強打者）**
      という 2 値ラベルを作る。
  - 打席数、打率、長打率、出塁率、四球率、三振率、年齢 などを説明変数として、
    - **ロジスティック回帰**で「強打者かどうか（0/1）」を予測する。

- **Titanic との対応**
  - Titanic の「Perished（0/1）」が、ここでは「StrongHitter（0/1）」になるイメージ。
  - 流れは `beginner.ipynb` とほぼ同じ：
    1. ライブラリ・データ読み込み
    2. データの概観・分析・前処理
    3. 機械学習モデルの構築・学習
    4. 予測の出力・評価

---

### 3. 分析の流れ（`beginner.ipynb` の焼き回し版）

#### 3.0 ライブラリ・データ読み込み

- **やること**
  - `pybaseball` / `pandas` / `numpy` / `matplotlib` / `seaborn` / `scikit-learn` をインポート。
  - `pybaseball.lahman.batting()` や `pybaseball.batting_stats(year)` などを使って、特定の年の打撃成績データを取得。
  - まずは 1 年分（例: 2023 年）だけ取得して CSV に保存し、Titanic の `train.csv` 的な位置づけにする。
- **初心者が理解しておきたいポイント**
  - 「ライブラリ」は、Python に機能を追加してくれる「道具箱」。
  - 今回は「野球データを取る道具」「表を扱う道具」「グラフを描く道具」「機械学習の道具」を読み込んでいると思えば OK。

#### 3.1 データの概観・分析（EDA）

- **やること**
  - `df.shape`, `df.head()`, `df.columns` でデータのサイズ・中身・カラム名を確認。
  - 欠損値を `df.isnull().sum()` で確認。
  - ヒストグラムや箱ひげ図で、打率・長打率・OPS の分布を見る。
  - 強打者ラベル（後述）と、各指標との関係を簡単に可視化する。
- **Titanic との対応**
  - Titanic: 生存率の円グラフ・カウントプロット →  
    野球: 強打者/非強打者の割合のカウントプロット。
  - Titanic: 相関ヒートマップ →  
    野球: 打率・出塁率・長打率・OPS などの相関ヒートマップ。
- **初心者にとっての学び**
  - 「データ分析は、いきなり機械学習ではなく、まずは**データを眺めて特徴をつかむ（EDA）**ところから始まる」という感覚。

#### 3.2 データの前処理

- **やること（簡単バージョン）**
  - 欠損値がたくさんあるカラム（たとえばマイナーな指標）は、最初は思い切って削除。
  - 文字列（チーム名、ポジションなど）のカラムも、`beginner.ipynb` と同様に、最初のバージョンでは削除してしまう。
  - 打席数が極端に少ない打者（例: 打席 20 未満）は、成績が安定していないのでデータから除外するなどの簡単なルールを入れる。
- **強打者ラベルの作成**
  - 例: OPS を使う場合
    - `ops_median = df['OPS'].median()` を計算。
    - `df['StrongHitter'] = (df['OPS'] >= ops_median).astype(int)` で 0/1 ラベルを作成。
  - こうして Titanic の `Perished` に対応する「目的変数」を作る。
- **初心者にとっての学び**
  - 「モデルに入れられない or 入れるとややこしいカラムは、まず削ってしまって OK」という割り切りを知る。
  - 0/1 ラベルの作り方（ルールベースで自分たちで決めてよい）が理解できる。

---

### 4. モデル構築・学習（ロジスティック回帰）

- **やること**
  - 説明変数 `X` と 目的変数 `y` に分ける：
    - `X`: 打席数、打率、出塁率、長打率、四球率、三振率 など数値カラム。
    - `y`: `StrongHitter`（0/1）。
  - `train_test_split` でデータを学習用（train）と検証用（valid）に分ける（例: 7:3）。
  - `LogisticRegression` でモデルを作成し、`fit(X_train, y_train)` で学習。
  - `score(X_train, y_train)` と `score(X_valid, y_valid)` を出して、過学習していないか軽くチェック。
- **Titanic との対応**
  - 構成は `beginner.ipynb` のロジスティック回帰とほぼ完全に同じ。
  - 変わるのは「列名」と「何を予測するか」だけ。
- **初心者にとっての学び**
  - ロジスティック回帰は「0/1 を予測するための、シンプルな機械学習モデル」と理解すれば十分。
  - 「訓練データ」と「テスト（検証）データ」を分ける理由（過学習を防ぐ）が具体例でイメージできる。

---

### 5. 予測と評価・考察

- **やること**
  - 学習済みモデルで `X_valid` に対して予測を行い、正解ラベル `y_valid` と比較して **正解率（accuracy）** を計算。
  - 余裕があれば、混同行列（Confusion Matrix）を描いて、
    - 強打者なのに外してしまったケース
    - 本当は強打者でないのに強打者と予測してしまったケース  
      を眺めてみる。
  - 「どの指標が効いていそうか？」を、係数や相関・散布図などから軽く解釈する。
- **発表での見せ方（例）**
  - 「○○ 年の MLB 打撃成績を用いて、“OPS がリーグ平均より高いかどうか” を予測したところ、検証用データで正解率は **約 XX %** だった」
  - 「モデルが特に苦手だったのは、打席数が少ない若手・代打専門の選手である」など、野球的な解釈を加える。

---

### 6. 3 人での役割分担案

- **メンバー A（データ担当）**
  - `pybaseball` を使ったデータ取得。
  - `pandas` による CSV 化・基本的な EDA（行数・列数、基本統計量、簡単なグラフ）。
- **メンバー B（前処理・モデル担当）**
  - 欠損値・不要カラムの処理。
  - ラベル（StrongHitter）の作成。
  - `train_test_split` とロジスティック回帰モデルの学習・精度計算。
- **メンバー C（可視化・考察・資料作成担当）**
  - 分布・相関ヒートマップ・混同行列などの可視化。
  - 「どういう打者を強打者として判定できているか」「どこで間違えやすいか」の考察。
  - 発表用スライド・レポートの作成。

---

### 7. 難易度と発展方向

- **難易度**
  - コア部分は `beginner.ipynb` とほぼ同じで、**Titanic をやったことがあれば難易度は低め**。
  - 違いは「データを pybaseball から取ってくる」ことと、「強打者ラベルを自分たちで定義する」こと。
- **発展方向（時間や余力があれば）**
  - `professional.ipynb` の内容を一部取り入れて、
    - 欠損値の賢い補完
    - カテゴリカル変数（ポジション、打撃左右など）の One-Hot Encoding
    - ランダムフォレストや他のモデルとの比較
  - 複数年のデータ（例: 2021〜2023 年）を使って、
    - 過去 2 年の平均成績から「翌年に強打者になりそうか」を予測する、などの「来季予測」方向に少し寄せる。

---

### 8. この企画のポイント

- **初心者向き**: 既存の Titanic 初心者ノートの流れをほぼそのまま使うため、実装のハードルが低い。
- **面白さ**: 教科書データではなく、**本物の MLB 打者データで “強打者予測モデル” を作る**という、野球ファンにも分かりやすい題材。
- **学び**:
  - データ取得、EDA、前処理、分類モデル、精度評価という一連の ML パイプラインを体験できる。
  - 「ラベル設計」「どの指標を特徴量として使うか」など、ドメイン知識と機械学習をつなげる考え方に触れられる。

この企画をベースに、次のステップとして「2022〜2024 年の成績から 2025 年の活躍を予測する」ような、より本格的な来季予測にも発展させることができます。
